\documentclass[ngerman, a4paper, 11pt]{scrreprt}
\usepackage{lmodern}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[backend=biber,style=authoryear]{biblatex}
% \usepackage[utf8]{fontenc}
\usepackage[a4paper,
left=3.5cm, right=3cm,
top=3cm, bottom=3cm]{geometry}
\usepackage{setspace}
\usepackage[multiple]{footmisc}
\geometry{verbose,a4paper}
\setcounter{secnumdepth}{3}
\setcounter{tocdepth}{3}

\usepackage{fancyhdr}
\usepackage{lipsum}
\usepackage{microtype}
\usepackage[clearempty]{titlesec}
\usepackage[ngerman]{babel}
\usepackage{acronym}

\usepackage[german,vario]{fancyref}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User specified LaTeX commands.
%% http://www.schlosser.info/in-latex-mit-varioreffancyref-automatisch-ab-seite-statt-auf-seite-setzen/
\makeatletter
\let\@f@ref@sav=\@f@ref
\renewcommand*{\@f@ref}[4]{%
  \def\@curtlabtype{#3}%
  \protect\@f@ref@sav{#1}{#2}{#3}{#4}%
}%
\addto\extrasngerman{%
  \renewcommand\reftextfaraway[1]{%
    \ifthenelse{\equal{\@curtlabtype}{chap}}{ab Seite}{auf Seite}~\pageref{#1}}%
  \renewcommand\reftextafter{%
    \ifthenelse{\equal{\@curtlabtype}{chap}}{ab der nächsten Seite}{auf der nächsten Seite}}%
}
\makeatother
%% src: http://tex.stackexchange.com/a/70847
\newcommand*{\fancyreflstlabelprefix}{lst}

\fancyrefaddcaptions{german}{%
  \providecommand*{\freflstname}{Quelltext}%
  \providecommand*{\Freflstname}{Quelltext}%
}

\frefformat{plain}{\fancyreflstlabelprefix}{\freflstname\fancyrefdefaultspacing#1}
\Frefformat{plain}{\fancyreflstlabelprefix}{\Freflstname\fancyrefdefaultspacing#1}

\frefformat{vario}{\fancyreflstlabelprefix}{%
  \freflstname\fancyrefdefaultspacing#1#3%
}
\Frefformat{vario}{\fancyreflstlabelprefix}{%
  \Freflstname\fancyrefdefaultspacing#1#3%
}


% \usepackage{jurabib}
% \jurabibsetup{
%     commabeforerest,
%     ibidem=strict,
%     citefull=first,
%     see,
%     titleformat={colonsep,all},
% }
%\usepackage{bibgerm}
\usepackage{array}
\usepackage{pst-pdf}
\usepackage{multicol}

%for autoref
%There are macros to change the default output with the help of the \renewcommand:
%\figurename             *\figurename*
%\tablename              *\tablename*
%\partname               *\partname*
%\appendixname           *\appendixname*
%\equationname           *\equationname*
%\Itemname               *\Itemname*
%\chaptername            *\chaptername*
%\sectionname            *\sectionname*
%\subsectionname         *\subsesctionname*
%\subsubsectionname      *\subsubsectionname*
%\paragraphname          *\paragraphname*
%\Hfootnotename          *\Hfootnotename*
%\AMSname                *\AMSname*
%\theoremname            *\theoremname*

\usepackage[german]{algorithm2e}
\usepackage{yhmath}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{subfig}

\usepackage{blindtext}
\usepackage[colorlinks=false, pdfborder={0 0 0}]{hyperref}

%%\input{german-backcitecom}

%%%% format
\setlength{\parindent}{3em}
\setlength{\parskip}{\baselineskip}
% \onehalfspacing

%% Definitions
\input{tex/def}

\ifpdf
  \usepackage{hyperref}
  \definecolor{darkblue}{rgb}{0,0,.5}
  \hypersetup
    { colorlinks=true
    , breaklinks=true
    , linkcolor=darkblue
    , menucolor=darkblue
    , urlcolor=darkblue
    , pdftitle={\projname -- \untertitel}
    , pdfsubject={\thesisname}
    , pdfauthor={\authorname}
    }
\else
\fi

%% Listings %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{listings}
\usepackage{sourcecodepro} % now the default typewriter font
\KOMAoptions{listof=totoc} % necessary because of scrhack
\renewcommand{\lstlistlistingname}{Quelltextverzeichnis}
\renewcommand{\lstlistingname}{Quelltext}
\lstset
  { basicstyle=\small\ttfamily
  , breaklines=true
  , captionpos=b
  , showstringspaces=false
  , keywordstyle=\color{blue}
  , backgroundcolor=\color{black!3}
  }

\lstnewenvironment{inlinehaskell}
{\spacing{1}\lstset{language=haskell,nolol,aboveskip=\bigskipamount}}
{\endspacing}

\newcommand{\haskellinput}[2][]{
  \begin{spacing}{1}
  \lstinputlisting[language=Haskell,nolol,aboveskip=\bigskipamount,#1]{#2}
  \end{spacing}
}

\newcommand{\haskellcode}[2][]{\mylisting[#1,language=Haskell]{#2}}

\newcommand{\mylisting}[2][]{
\begin{spacing}{1}
\lstinputlisting[frame=lines,aboveskip=2\bigskipamount,#1]{#2}
\end{spacing}
}
